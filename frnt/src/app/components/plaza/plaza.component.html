<div class="page-container">
  <div class="page-header">
    <h2>🏬 Plazas Registradas</h2>
    <p class="subtitle">Gestión de plazas de mercado</p>
    <span *ngIf="!canEdit" class="role-badge readonly">Solo lectura</span>
    <div class="spacer"></div>
    <button class="btn" (click)="newPlaza()" [disabled]="!canEdit">Nueva plaza</button>
  </div>

  <div class="two-columns">
    <div class="content-card" *ngIf="plazas.length > 0; else noData">
      <table class="data-table">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Dirección</th>
            <th>Teléfono</th>
            <th>Horario</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let plaza of plazas">
            <td>{{ plaza.name }}</td>
            <td>{{ plaza.address }}</td>
            <td>{{ plaza.phoneNumber }}</td>
            <td>{{ plaza.openingHours }} - {{ plaza.closingHours }}</td>
            <td>
              <button class="btn" (click)="select(plaza)" [disabled]="!canEdit">Editar</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="form-card">
      <h3>{{ isCreating ? 'Crear Plaza' : 'Editar Plaza' }}</h3>
      <form [formGroup]="form" (ngSubmit)="save()">
        <div class="form-grid">
          <label>
            <span>Nombre</span>
            <input type="text" formControlName="name" placeholder="Ej. Plaza Central" />
          </label>
          <label>
            <span>Dirección</span>
            <input type="text" formControlName="address" placeholder="Calle 1 # 2-34" />
          </label>
          <label>
            <span>Teléfono</span>
            <input type="text" formControlName="phoneNumber" placeholder="Ej. 3001234567" />
          </label>
          <label>
            <span>Email</span>
            <input type="email" formControlName="email" placeholder="ejemplo@plaza.com" />
          </label>
          <label>
            <span>Hora Apertura</span>
            <input type="time" formControlName="openingHours" />
          </label>
          <label>
            <span>Hora Cierre</span>
            <input type="time" formControlName="closingHours" />
          </label>
          <label class="full">
            <span>Descripción</span>
            <textarea formControlName="description" rows="3" placeholder="Descripción breve de la plaza"></textarea>
          </label>
        </div>
        <div class="form-actions">
          <button class="btn primary" type="submit" [disabled]="form.invalid || !canEdit">{{ isCreating ? 'Crear' : 'Guardar' }}</button>
          <button class="btn" type="button" (click)="cancel()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <ng-template #noData>
    <div class="empty-state">
      <div class="empty-icon">📦</div>
      <h3>No hay plazas disponibles</h3>
      <p>Aún no se han registrado plazas en el sistema</p>
    </div>
  </ng-template>
</div>
